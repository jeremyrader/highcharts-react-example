<html>

    <head>
        <script src="http://code.jquery.com/jquery-3.1.1.min.js"></script>
        <script src="http://code.highcharts.com/highcharts.js"></script>
    
    </head>
    
    <body>
    
        
        <div id="container" style="width:100%; height:400px;"></div>
        
        <script> 

            $.ajax({
                url: '/cityForecasts',
                success: function(data) {
                    localStorage.setItem('cityForecasts', JSON.stringify(data.cityForecasts)); 
                }
                
            });
 
            $(function () { 
                
                let cityForecasts = JSON.parse(localStorage.getItem('cityForecasts'));
                
                let series = [];
                
                for (cityForecast of cityForecasts) {

                    series.push({
                        name: cityForecast.city + ',' + cityForecast.country,
                        data: cityForecast.forecast
                    });   

                }

                var myChart = Highcharts.chart('container', {
                    chart: {
                        type: 'line'
                    },
                    title: {
                        text: 'Weather forecast for major cities'
                    },
                    xAxis: {
                        type: 'datetime',
                        tickInterval: 24 * 3600 * 1000,
                    },
                    yAxis: {
                        title: {
                            text: 'Degrees Kelvin'
                        },
                        labels: {
                            formatter: function() {
                                return this.value + 'Â° K';   
                            }
                        }
                    },
                    series: series
                });
                
            });
        
        </script>
    
    </body>

</html>